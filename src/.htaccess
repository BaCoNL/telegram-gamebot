# Protect sensitive files
<FilesMatch "^(config\.php|.*\.md|composer\.(json|lock))$">
    Require all denied
</FilesMatch>

RewriteEngine On

# Whitelist IPs for full access (bypass rewrites)
RewriteCond %{REMOTE_ADDR} =31.20.46.73 [OR]
RewriteCond %{REMOTE_ADDR} =93.95.252.178
RewriteRule ^ - [L]

# Allow everyone to access the Telegram webhook endpoint directly
RewriteCond %{REQUEST_URI} ^/telegram-webhook\.php$
RewriteRule ^ - [L]

# Otherwise, force all other requests to telegram-webhook.php
RewriteRule ^.*$ /telegram-webhook.php [L,QSA]
